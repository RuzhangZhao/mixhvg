<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mixture of Multiple Highly Variable Feature Selection Methods • mixhvg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Mixture of Multiple Highly Variable Feature Selection Methods">
<meta property="og:description" content="Highly variable gene selection methods, including popular public available methods, and also the mixture of multiple highly variable gene selection methods, &lt;https://github.com/RuzhangZhao/mixhvg&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">mixhvg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="mixhvg-mixture-of-highly-variable-gene-selection-">mixhvg: Mixture of Highly Variable Gene Selection <img src="Figures/imgfile.png" align="right" width="160px"><a class="anchor" aria-label="anchor" href="#mixhvg-mixture-of-highly-variable-gene-selection-"></a>
</h1></div>

<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>The package <strong>mixhvg</strong> works for highly variable gene selection, including popular public available methods, and also the mixture of multiple highly variable gene selection methods. The mixture of methods can combine the advantages captured by each single method.</p>
<p>This function <strong>FindVariableFeaturesMix</strong> inherits from FindVariableFeatures function of Seurat Package, which can be used the same as FindVariableFeatures. Also, it accepts the dense or sparse matrix input.</p>
</div>
<div class="section level3">
<h3 id="download">Download<a class="anchor" aria-label="anchor" href="#download"></a>
</h3>
<p>Please download the <a href="https://CRAN.R-project.org/package=mixhvg" class="external-link"><strong>mixhvg</strong> package from CRAN</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"mixhvg"</span><span class="op">)</span></span></code></pre></div>
<p>Please use GitHub repo to download the most updated package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"RuzhangZhao/mixhvg"</span><span class="op">)</span></span></code></pre></div>
<p>### Usage</p>
<p>There are two inputs can be used in <strong>FindVariableFeaturesMix</strong> function.</p>
<p>The example data comes from <a href="https://www.10xgenomics.com/resources/datasets/pbmc-from-a-healthy-donor-granulocytes-removed-through-cell-sorting-3-k-1-standard-2-0-0" class="external-link">10x Genomics</a>. You may use <a href="https://github.com/RuzhangZhao/pbmc3k/raw/main/pbmc3k_rna.rds" class="external-link">this link</a> to download the processed data. The processed data is named as <code>pbmc3k_rna.rds</code>.</p>
<div class="section level4">
<h4 id="seurat-object-as-input">Seurat Object as Input<a class="anchor" aria-label="anchor" href="#seurat-object-as-input"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbmc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"pbmc3k_rna.rds"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mixhvg</span><span class="op">)</span></span>
<span><span class="va">object</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span>
<span><span class="va">object</span><span class="op">&lt;-</span><span class="fu"><a href="reference/FindVariableFeaturesMix.html">FindVariableFeaturesMix</a></span><span class="op">(</span><span class="va">object</span>,nfeatures<span class="op">=</span><span class="fl">2000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/VariableFeatures.html" class="external-link">VariableFeatures</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] "CD74"  "LYZ"   "IGLC3" "IGKC"  "RPS29" "IGHA1"</span></span></code></pre></div>
<p>One may use <strong>FindVariableFeaturesMix</strong> to replace the <strong>FindVariableFeatures</strong> function in the analysis pipeline of Seurat. For example,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span>
<span><span class="va">object</span><span class="op">&lt;-</span><span class="fu"><a href="reference/FindVariableFeaturesMix.html">FindVariableFeaturesMix</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="va">object</span><span class="op">&lt;-</span><span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">object</span>,verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">object</span><span class="op">&lt;-</span><span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="va">object</span>,verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">object</span><span class="op">&lt;-</span><span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span><span class="va">object</span>,npcs<span class="op">=</span><span class="fl">30</span>,verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">object</span><span class="op">&lt;-</span><span class="fu"><a href="https://satijalab.org/seurat/reference/RunUMAP.html" class="external-link">RunUMAP</a></span><span class="op">(</span><span class="va">object</span>,dims<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>,verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="matrix-as-input">Matrix as Input<a class="anchor" aria-label="anchor" href="#matrix-as-input"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbmc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"pbmc3k_rna.rds"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mixhvg</span><span class="op">)</span></span>
<span><span class="va">pbmc_hvg</span><span class="op">&lt;-</span><span class="fu"><a href="reference/FindVariableFeaturesMix.html">FindVariableFeaturesMix</a></span><span class="op">(</span><span class="va">pbmc</span>,nfeatures<span class="op">=</span><span class="fl">2000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pbmc_hvg</span><span class="op">)</span></span>
<span><span class="co"># [1] "CD74"  "LYZ"   "IGLC3" "IGKC"  "RPS29" "IGHA1"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="different-methods">Different Methods<a class="anchor" aria-label="anchor" href="#different-methods"></a>
</h4>
<p>The <code>method.names</code> can take one method or multiple methods for mixture.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbmc_hvg</span><span class="op">&lt;-</span><span class="fu"><a href="reference/FindVariableFeaturesMix.html">FindVariableFeaturesMix</a></span><span class="op">(</span><span class="va">pbmc</span>,method.names<span class="op">=</span><span class="st">"seuratv3"</span><span class="op">)</span></span>
<span><span class="va">pbmc_hvg</span><span class="op">&lt;-</span><span class="fu"><a href="reference/FindVariableFeaturesMix.html">FindVariableFeaturesMix</a></span><span class="op">(</span><span class="va">pbmc</span>,method.names<span class="op">=</span><span class="st">"scran"</span><span class="op">)</span></span>
<span><span class="va">pbmc_hvg</span><span class="op">&lt;-</span><span class="fu"><a href="reference/FindVariableFeaturesMix.html">FindVariableFeaturesMix</a></span><span class="op">(</span><span class="va">pbmc</span>,</span>
<span>          method.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scran"</span>,<span class="st">"scran_pos"</span>,<span class="st">"seuratv1"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="method-choices">Method Choices<a class="anchor" aria-label="anchor" href="#method-choices"></a>
</h3>
<p>The following methods can be chosen. And also, any mixture of the following methods is acceptable. For example, the default is c(“scran”,“seuratv1”,“mv_PFlogPF”,“scran_pos”)</p>
<ul>
<li>
<strong>scran</strong>: Use mean-variance curve adjustment on lognormalized count matrix, which is scran ModelGeneVar.</li>
<li>
<strong>mv_ct</strong>: Use mean-variance curve adjustment on count matrix, inherited from scran ModelGeneVar.</li>
<li>
<strong>mv_nc</strong>: Use mean-variance curve adjustment on normalized count matrix, inherited from scran ModelGeneVar.</li>
<li>
<strong>mv_lognc</strong>: The same as scran.</li>
<li>
<strong>mv_PFlogPF</strong>: Use mean-variance curve adjustment on PFlog1pPF matrix, inherited from scran ModelGeneVar.</li>
<li>
<strong>scran_pos</strong>: Use scran poisson version, modelGeneVarByPoisson.</li>
<li>
<strong>seuratv3</strong>: Use logmean-logvariance curve adjustment on count matrix, which is vst, Seurat FindVariableFeatures Function(<a href="https://satijalab.org/seurat/reference/findvariablefeatures" class="external-link uri">https://satijalab.org/seurat/reference/findvariablefeatures</a>).</li>
<li>
<strong>logmv_ct</strong>: The same as seuratv3.</li>
<li>
<strong>logmv_nc</strong>: Use logmean-logvariance curve adjustment on normalized count matrix, inherited from seuratv3(vst).</li>
<li>
<strong>logmv_lognc</strong>: Use logmean-logvariance curve adjustment on lognormalized count matrix, inherited from seuratv3(vst).</li>
<li>
<strong>logmv_PFlogPF</strong>: Use logmean-logvariance curve adjustment on PFlog1pPF matrix, inherited from seuratv3(vst).</li>
<li>
<strong>seuratv1</strong>: Use dispersion on lognormalized count matrix, which is dispersion (disp), Seurat FindVariableFeatures Function(<a href="https://satijalab.org/seurat/reference/findvariablefeatures" class="external-link uri">https://satijalab.org/seurat/reference/findvariablefeatures</a>).</li>
<li>
<strong>disp_lognc</strong>: The same as seuratv1.</li>
<li>
<strong>disp_PFlogPF</strong>: Use dispersion on PFlog1pPF matrix, inherited from seuratv1(disp).</li>
<li>
<strong>mean_max_ct</strong>: Highly Expressed Features with respect to count matrix.</li>
<li>
<strong>mean_max_nc</strong>: Highly Expressed Features with respect to normalized count matrix.</li>
<li>
<strong>mean_max_lognc</strong>: Highly Expressed Features with respect to lognormalized count matrix</li>
</ul>
<p>The table below can describe the data format and mean adjustment combination.</p>
<p><img src="Figures/Fig.method.png" alt="Fig2" style="zoom:50%;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=mixhvg" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mixhvg</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ruzhang Zhao <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3420-5771" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=mixhvg" class="external-link"><img src="http://www.repostatus.org/badges/latest/active.svg" alt="Project Status"></a></li>
<li><a href="https://cran.r-project.org/package=mixhvg" class="external-link"><img src="https://ci.appveyor.com/api/projects/status/a28cs08ug9qng8hn?svg=true" alt="Build app"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Ruzhang Zhao.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
